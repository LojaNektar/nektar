<!DOCTYPE html>
<html lang="pt-BR">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Cat√°logo de T√™nis Premium e Importados</title>
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="css/index.css">
	<style>
		.em-breve {
			display: flex;
			align-items: center;
			justify-content: center;
			height: 300px;
			background: #111;
			color: #888;
			font-size: 1.2rem;
			border-radius: 12px;
			border: 1px dashed #333;
		}

		.zoom-area {
		    position: relative;
		    overflow: hidden;
		    background: #000;
		    display: flex;
		    justify-content: center;
		    align-items: center;
		    height: 480px;
		    touch-action: none;
		  }
		
		  .zoom-area img {
		    transition: transform 0.25s ease;
		    max-height: 100%;
		    cursor: grab;
		  }
		
		  .zoomed {
		    cursor: grabbing !important;
		  }
		
		  @media (max-width: 768px) {
		    .zoom-area {
		      height: 340px;
		    }
		  }
		
		.valor {
			font-size: 1rem;
			margin-bottom: .3rem;
		}
		
		.valor span {
			display: block;
			font-size: 0.9rem;
			color: #555;
		}
	</style>
</head>

<body>
	<div class="container py-4">
		<h1 class="text-center mb-4">Cat√°logo de T√™nis Premium e Importados</h1>

		<!-- Navega√ß√£o -->
		<div class="row mb-4">
			<nav class="col-12 d-flex flex-wrap gap-2 justify-content-center" aria-label="Menu principal">
				<a href="index.html" class="btn-grad btn">In√≠cio</a>
				<a href="perfumes.html" class="btn-grad btn">Perfumes Importados</a>
				<a href="arabes.html" class="btn-grad btn">Perfumes √Årabes</a>
				<a href="tenis.html" class="btn-grad btn active">T√™nis</a>
			</nav>
		</div>

		<!-- Campo de busca -->
		<div class="row mb-4">
			<div class="col-md-6 mx-auto">
				<input type="text" id="search" class="form-control" placeholder="üîç Buscar modelo ou marca...">
			</div>
		</div>

		<!-- Header de categorias -->
		<div class="categorias-header mb-3">
			<h5>Filtrar por Marca</h5>
			<div class="categorias-lista" id="marcasTabs"></div>
		</div>

		<!-- Container principal -->
		<div id="catalogoContainer"></div>
	</div>

	<!-- Modal de visualiza√ß√£o -->
	<div class="modal fade" id="modalImagem" tabindex="-1">
	  <div class="modal-dialog modal-dialog-centered" style="max-width: 850px;">
	    <div class="modal-content bg-dark text-light border-0">
	      <div class="modal-header border-0">
	        <h5 class="modal-title">Visualiza√ß√£o do produto</h5>
	        <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
	      </div>
	      <div class="modal-body text-center" id="modalConteudo" style="padding:0;"></div>
	      <div class="modal-footer border-0">
	        <button type="button" class="btn btn-outline-light" data-bs-dismiss="modal">Fechar</button>
	      </div>
	    </div>
	  </div>
	</div>

	<script>
		let tenis = [];

		function renderizarMarcas(lista) {
			const marcas = [...new Set(lista.map(p => p.Marca))].sort();
			const tabs = document.getElementById("marcasTabs");
			const container = document.getElementById("catalogoContainer");

			tabs.innerHTML = "";
			container.innerHTML = "";

			marcas.forEach(marca => {
				const marcaId = marca.toLowerCase().replace(/[^a-z0-9]+/g, "-");

				tabs.innerHTML += `<button onclick="scrollToSection('${marcaId}')">${marca}</button>`;

				const produtosMarca = lista.filter(p => p.Marca === marca);
				container.innerHTML += gerarHTMLMarca(marca, produtosMarca);
			});
		}

		function gerarHTMLMarca(marca, lista) {
			return `
				<section id="${marca.toLowerCase().replace(/[^a-z0-9]+/g, "-")}" class="mb-5">
					<h3 class="text-gradient mb-3">${marca}</h3>
					<div class="row g-3">
						${lista.map(p => {
							const valorStr = p.Venda.replace(/[^\d,]/g, '').replace(',', '.');
							const valor = parseFloat(valorStr);
							const valorPix = isNaN(valor) ? null : (valor * 0.9).toFixed(2);
							const valorPixFmt = valorPix ? `R$ ${valorPix.replace('.', ',')}` : '‚Äî';
							return `
								<div class="col-6 col-md-4 col-lg-3">
									<div class="card h-100" onclick='abrirModal(${JSON.stringify(p).replace(/"/g, "&quot;")})'>
										${p.Imagem1 ? `<img src="${p.Imagem1}" alt="${p.Modelos}">`
										: `<div class="em-breve">üïí Imagens em breve</div>`}
										<div class="card-body">
											<h5>${p.Modelos}</h5>
											<p><strong>Marca:</strong> ${p.Marca}</p>
											<p>${p.Tamanho ? `<strong>Tamanho:</strong> ${p.Tamanho}` : ""}</p>
											<p class="valor"><strong>${p.Venda}</strong><span>em at√© 3x sem juros</span></p>
											<p class="valor"><strong>${valorPixFmt}</strong><span>√† vista no Pix (10% OFF)</span></p>
											<a href="https://wa.me/5537998195214?text=Ol√°!%20Tenho%20interesse%20no%20t√™nis%20${encodeURIComponent(p.Marca)}%20${encodeURIComponent(p.Modelos)}."
												target="_blank" class="badge-what">üí¨ Falar no WhatsApp</a>
										</div>
									</div>
								</div>`;
						}).join("")}
					</div>
				</section>`;
		}

		function scrollToSection(id) {
			const section = document.getElementById(id);
			if (section) section.scrollIntoView({ behavior: "smooth", block: "start" });
		}

	  function abrirModal(produto) {
		const modalConteudo = document.getElementById("modalConteudo");
		const imagens = [
		  produto.Imagem1, produto.Imagem2, produto.Imagem3,
		  produto.Imagem4, produto.Imagem5, produto.Imagem6, produto.Imagem7
		].filter(img => img && img.trim() !== "");
	
		if (imagens.length > 0) {
		  modalConteudo.innerHTML = `
			<div id="carouselImagens" class="carousel slide" data-bs-ride="carousel">
			  <div class="carousel-inner">
				${imagens.map((img, i) => `
				  <div class="carousel-item ${i === 0 ? 'active' : ''}">
					<div class="zoom-area">
					  <img src="${img}" class="zoomable d-block" alt="${produto.Modelos}">
					</div>
				  </div>`).join("")}
			  </div>
			  <button class="carousel-control-prev" type="button" data-bs-target="#carouselImagens" data-bs-slide="prev">
				<span class="carousel-control-prev-icon"></span>
			  </button>
			  <button class="carousel-control-next" type="button" data-bs-target="#carouselImagens" data-bs-slide="next">
				<span class="carousel-control-next-icon"></span>
			  </button>
			</div>`;
		  setTimeout(inicializarZoom, 300);
		} else {
		  modalConteudo.innerHTML = `<div class="em-breve">üïí Imagens em breve</div>`;
		}
	
		document.querySelector("#modalImagem .modal-title").innerText =
		  `${produto.Marca} - ${produto.Modelos}`;
		new bootstrap.Modal(document.getElementById("modalImagem")).show();
	  }
	
	  function inicializarZoom() {
		document.querySelectorAll('.zoomable').forEach(img => {
		  let scale = 1;
		  let originX = 0, originY = 0;
		  let isDragging = false, startX = 0, startY = 0;
	
		  // Zoom com scroll do mouse
		  img.addEventListener('wheel', e => {
			e.preventDefault();
			const delta = e.deltaY > 0 ? -0.1 : 0.1;
			scale = Math.min(Math.max(1, scale + delta), 3);
			img.style.transform = `translate(${originX}px, ${originY}px) scale(${scale})`;
		  });
	
		  // Clique e arraste (desktop)
		  img.addEventListener('mousedown', e => {
			if (scale > 1) {
			  isDragging = true;
			  startX = e.clientX;
			  startY = e.clientY;
			  img.classList.add('zoomed');
			}
		  });
	
		  window.addEventListener('mouseup', () => {
			isDragging = false;
			img.classList.remove('zoomed');
		  });
	
		  img.addEventListener('mousemove', e => {
			if (!isDragging) return;
			originX += e.clientX - startX;
			originY += e.clientY - startY;
			startX = e.clientX;
			startY = e.clientY;
			img.style.transform = `translate(${originX}px, ${originY}px) scale(${scale})`;
		  });
	
		  // Pinch Zoom no celular
		  let startDistance = 0;
		  img.addEventListener('touchstart', e => {
			if (e.touches.length === 2) {
			  const dx = e.touches[0].pageX - e.touches[1].pageX;
			  const dy = e.touches[0].pageY - e.touches[1].pageY;
			  startDistance = Math.hypot(dx, dy);
			}
		  });
	
		  img.addEventListener('touchmove', e => {
			if (e.touches.length === 2) {
			  const dx = e.touches[0].pageX - e.touches[1].pageX;
			  const dy = e.touches[0].pageY - e.touches[1].pageY;
			  const newDistance = Math.hypot(dx, dy);
			  const zoomFactor = newDistance / startDistance;
			  scale = Math.min(Math.max(1, zoomFactor * scale), 3);
			  img.style.transform = `scale(${scale})`;
			  e.preventDefault();
			}
		  });
		});
	  }

		async function carregarDados() {
			try {
				const response = await fetch("catalogo/tenis.json");
				if (!response.ok) throw new Error("Falha no fetch do JSON");
				tenis = await response.json();
				renderizarMarcas(tenis);
			} catch (error) {
				console.warn("Erro ao carregar JSON, usando fallback JS:", error);
				const script = document.createElement("script");
				script.src = "catalogo/tenis.js";
				script.onload = () => {
					if (typeof tenisBackup !== "undefined") {
						tenis = tenisBackup;
						renderizarMarcas(tenis);
					}
				};
				document.body.appendChild(script);
			}
		}

		document.getElementById("search").addEventListener("input", e => {
			const termo = e.target.value.toLowerCase();
			const filtrados = tenis.filter(p =>
				p.Modelos.toLowerCase().includes(termo) ||
				p.Marca.toLowerCase().includes(termo)
			);
			renderizarMarcas(filtrados);
		});

		carregarDados();
	</script>

	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>

	<footer>
		¬© 2025 Nektar. Todos os direitos reservados.<br>
		<small>Feito com üíô e estilo.</small>
	</footer>
</body>

</html>
