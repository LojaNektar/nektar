<!DOCTYPE html>
<html lang="pt-BR">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>CatÃ¡logo de TÃªnis Premium e Importados</title>
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="css/index.css">
	<style>
		.em-breve {
			display: flex;
			align-items: center;
			justify-content: center;
			height: 300px;
			background: #111;
			color: #888;
			font-size: 1.2rem;
			border-radius: 12px;
			border: 1px dashed #333;
		}

		Â  .zoom-area {
		Â  Â  position: relative;
		Â  Â  overflow: hidden;
		Â  Â  background: #000;
		Â  Â  display: flex;
		Â  Â  justify-content: center;
		Â  Â  align-items: center;
		Â  Â  height: 460px;
		Â  Â  touch-action: none;
		Â  }
		
		Â  .zoom-area img {
		Â  Â  transition: transform 0.3s ease;
		Â  Â  max-height: 100%;
		Â  Â  max-width: 100%;
		Â  Â  cursor: zoom-in;
		Â  Â  transform-origin: center center;
		Â  }
		
		Â  .zoomed {
		Â  Â  cursor: grab;
		Â  }
		
		Â  @media (max-width: 768px) {
		Â  Â  .zoom-area {
		Â  Â  Â  height: 340px;
		Â  Â  }
		Â  }
		
		.valor {
			font-size: 1rem;
			margin-bottom: .3rem;
		}
		
		.valor span {
			display: block;
			font-size: 0.9rem;
			color: #555;
		}
		
		/* --- ESTILOS DO CARRINHO --- */
		.carrinho-flutuante {
			position: fixed;
			bottom: 20px;
			right: 20px;
			background-color: #25D366;
			color: white;
			border: none;
			border-radius: 50px;
			padding: 15px 25px;
			font-size: 1.1em;
			font-weight: bold;
			box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
			cursor: pointer;
			z-index: 1000;
			display: flex;
			align-items: center;
			gap: 8px;
			transition: background-color 0.3s;
		}

		.carrinho-flutuante:hover {
			background-color: #128C7E;
		}

		#contadorCarrinho {
			background-color: #ffc107;
			color: #333;
			border-radius: 50%;
			padding: 4px 8px;
			font-size: 0.9em;
			line-height: 1;
		}
		
		.btn-add-carrinho {
		    background-color: #198754; 
		    color: white;
		    border: none;
		    transition: background-color 0.3s;
			margin-top: 10px;
		}
		
		.btn-add-carrinho:hover {
		    background-color: #157347;
		    color: white;
		}
		
		.card-body {
			padding-bottom: 15px !important;
		}
		
		/* Faz com que a imagem do card tenha cursor para indicar clique (para abrir o zoom modal) */
		.card-img-top {
			cursor: zoom-in;
		}
		
		/* Estilo para o modal de carrinho */
		#modalCarrinho .modal-footer {
			border-top: none;
			padding-top: 0;
		}
		#modalCarrinho .modal-body {
			padding-bottom: 0;
		}
	</style>
</head>

<body>
	<div class="container py-4">
		<h1 class="text-center mb-4">CatÃ¡logo de TÃªnis Premium e Importados</h1>

		<div class="row mb-4">
			<nav class="col-12 d-flex flex-wrap gap-2 justify-content-center" aria-label="Menu principal">
				<a href="index.html" class="btn-grad btn">InÃ­cio</a>
				<a href="perfumes.html" class="btn-grad btn">Perfumes Importados</a>
				<a href="arabes.html" class="btn-grad btn">Perfumes Ãrabes</a>
				<a href="tenis.html" class="btn-grad btn active">TÃªnis</a>
			</nav>
		</div>

		<div class="row mb-4">
			<div class="col-md-6 mx-auto">
				<input type="text" id="search" class="form-control" placeholder="ğŸ” Buscar modelo ou marca...">
			</div>
		</div>

		<div class="categorias-header mb-3">
			<h5>Filtrar por Marca</h5>
			<div class="categorias-lista" id="marcasTabs"></div>
		</div>

		<div id="catalogoContainer"></div>
	</div>

	<div class="modal fade" id="modalImagem" tabindex="-1">
	Â  <div class="modal-dialog modal-dialog-centered" style="max-width: 850px;">
	Â  Â  <div class="modal-content bg-dark text-light border-0">
	Â  Â  Â  <div class="modal-header border-0">
	Â  Â  Â  Â  <h5 class="modal-title">VisualizaÃ§Ã£o do produto</h5>
	Â  Â  Â  Â  <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
	Â  Â  Â  </div>
	Â  Â  Â  <div class="modal-body text-center" id="modalConteudo" style="padding:0;"></div>
	Â  Â  Â  <div class="modal-footer border-0">
	Â  Â  Â  Â  <button type="button" class="btn btn-outline-light" data-bs-dismiss="modal">Fechar</button>
	Â  Â  Â  </div>
	Â  Â  </div>
	Â  </div>
	</div>

	<button id="abrirCarrinho" class="carrinho-flutuante" onclick="abrirModalCarrinho()">
	    ğŸ›’ Meu Pedido (<span id="contadorCarrinho">0</span>)
	</button>
	<div class="modal fade" id="modalCarrinho" tabindex="-1" aria-labelledby="modalCarrinhoLabel" aria-hidden="true">
		<div class="modal-dialog modal-dialog-centered modal-lg">
			<div class="modal-content">
				<div class="modal-header">
					<h5 class="modal-title" id="modalCarrinhoLabel">ğŸ›’ Seu Pedido</h5>
					<button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
				</div>
				<div class="modal-body">
					<div id="itensCarrinhoLista">
						</div>
				</div>
				<div class="modal-footer d-flex flex-column align-items-stretch">
					<p class="h4 text-end mb-3" id="carrinhoTotal">Total Estimado: R$ 0,00</p>
					<button type="button" class="btn btn-success btn-lg w-100" onclick="finalizarPedidoWhatsApp()">
						âœ… Finalizar Pedido no WhatsApp
					</button>
					<button type="button" class="btn btn-outline-secondary mt-2" data-bs-dismiss="modal">
						Continuar Comprando
					</button>
				</div>
			</div>
		</div>
	</div>
	<script>
		let tenis = [];
		const NUMERO_WHATSAPP = "5537998195214";
		let carrinho = [];

		// --- FunÃ§Ãµes de Carrinho (NOVAS) ---
		function carregarCarrinho() {
			try {
				carrinho = JSON.parse(localStorage.getItem('carrinho')) || [];
			} catch (e) {
				carrinho = [];
			}
			atualizarContadorCarrinho();
		}
		
		function salvarCarrinho() {
		    localStorage.setItem('carrinho', JSON.stringify(carrinho));
		    atualizarContadorCarrinho();
		}

		function atualizarContadorCarrinho() {
			const contador = document.getElementById('contadorCarrinho');
			if (contador) {
				contador.innerText = carrinho.length;
			}
		}

		function adicionarAoCarrinho(nome, marca, venda, tipo = 'TÃªnis') {
			const item = {
				nome: nome,
				marca: marca,
				preco: venda,
				tipo: tipo,
				id: Date.now() 
			};
			carrinho.push(item);
			salvarCarrinho();
			alert(`${nome} (${marca}) foi adicionado ao seu pedido!`);
		}
		
		function removerDoCarrinho(id) {
		    // 1. Remove o item
		    carrinho = carrinho.filter(item => item.id !== id);
		    salvarCarrinho();
		
		    // 2. Verifica se o carrinho ficou vazio apÃ³s a remoÃ§Ã£o
		    if (carrinho.length === 0) {
		        // Se estiver vazio, fecha o modal imediatamente
		        const modalEl = document.getElementById('modalCarrinho');
		        const modal = bootstrap.Modal.getInstance(modalEl);
		        if (modal) modal.hide();
		    } else {
		        // Se ainda houver itens, re-renderiza a lista (mantendo o modal aberto)
		        abrirModalCarrinho(true); 
		    }
		}
		
		function stringParaFloat(precoStr) {
			if (!precoStr) return 0;
			return parseFloat(precoStr.replace('R$', '').replace('.', '').replace(',', '.').trim()) || 0;
		}

		function abrirModalCarrinho(reabrir = false) {
		    // 1. Mova a verificaÃ§Ã£o de carrinho vazio para a abertura do modal principal (se nÃ£o for re-renderizaÃ§Ã£o)
		    if (carrinho.length === 0) {
		        // Se for uma tentativa de abertura e estiver vazio, mostra o alerta e retorna
		        if (!reabrir) {
		            alert("Seu pedido estÃ¡ vazio. Adicione um ou mais produtos!");
		        }
		        return;
		    }
		    
		    // 2. Se houver itens, preenche o modal normalmente
		    const listaContainer = document.getElementById('itensCarrinhoLista');
		    let html = `<ul class="list-group list-group-flush">`;
		    let totalEstimado = 0;
		
		    carrinho.forEach(item => {
		        const valorItem = stringParaFloat(item.preco);
		        totalEstimado += valorItem;
		
		        html += `
		            <li class="list-group-item d-flex justify-content-between align-items-center">
		                <div>
		                    <strong>${item.tipo}:</strong> ${item.nome} (${item.marca})<br>
		                    <small class="text-muted">${item.preco}</small>
		                </div>
		                <button class="btn btn-sm btn-danger" onclick="removerDoCarrinho(${item.id})">
		                    Remover
		                </button>
		            </li>
		        `;
		    });
		
		    html += `</ul>`;
		    listaContainer.innerHTML = html;
		
		    const totalFormatado = totalEstimado.toLocaleString('pt-BR', { style: 'currency', currency: 'BRL' });
		    document.getElementById('carrinhoTotal').innerHTML = `Total Estimado: ${totalFormatado}`;
		    
		    if (!reabrir) {
		        // Apenas abre o modal se nÃ£o estivermos apenas re-renderizando
		        const modal = new bootstrap.Modal(document.getElementById("modalCarrinho"));
		        modal.show();
		    }
		}

		function finalizarPedidoWhatsApp() {
		    if (carrinho.length === 0) {
		        alert("O carrinho estÃ¡ vazio. Adicione itens antes de finalizar.");
		        return;
		    }
		
		    let mensagem = "OlÃ¡! Gostaria de finalizar a compra dos seguintes itens:\n\n";
		    let totalEstimado = 0;
		
		    carrinho.forEach((item, index) => {
		        const valorItem = stringParaFloat(item.preco);
		        totalEstimado += valorItem;
		
		        mensagem += `${index + 1}. [${item.tipo}] ${item.nome} (${item.marca}) - ${item.preco}\n`;
		    });
		
		    const totalFormatado = totalEstimado.toLocaleString('pt-BR', { style: 'currency', currency: 'BRL' });
		    
		    mensagem += `\nTotal Estimado: ${totalFormatado}`;
		    mensagem += `\n*Os valores sÃ£o estimados. Favor confirmar disponibilidade e preÃ§o final.`;
		
		    const linkWhatsApp = `https://wa.me/${NUMERO_WHATSAPP}?text=${encodeURIComponent(mensagem)}`;
		
			// Fecha o modal antes de abrir o WhatsApp
			const modalEl = document.getElementById('modalCarrinho');
			const modal = bootstrap.Modal.getInstance(modalEl);
			if (modal) modal.hide();
			
		    window.open(linkWhatsApp, '_blank');
		}

		// --- FunÃ§Ãµes de RenderizaÃ§Ã£o e Zoom (Mantidas) ---

		function renderizarMarcas(lista) {
			const marcas = [...new Set(lista.map(p => p.Marca))].sort();
			const tabs = document.getElementById("marcasTabs");
			const container = document.getElementById("catalogoContainer");

			tabs.innerHTML = "";
			container.innerHTML = "";

			marcas.forEach(marca => {
				const marcaId = marca.toLowerCase().replace(/[^a-z0-9]+/g, "-");

				tabs.innerHTML += `<button onclick="scrollToSection('${marcaId}')">${marca}</button>`;

				const produtosMarca = lista.filter(p => p.Marca === marca);
				container.innerHTML += gerarHTMLMarca(marca, produtosMarca);
			});
		}

		function gerarHTMLMarca(marca, lista) {
			return `
				<section id="${marca.toLowerCase().replace(/[^a-z0-9]+/g, "-")}" class="mb-5">
					<h3 class="text-gradient mb-3">${marca}</h3>
					<div class="row g-3">
						${lista.map(p => {
							const valorStr = p.Venda.replace(/[^\d,]/g, '').replace(',', '.');
							const valor = parseFloat(valorStr);
							const valorPix = isNaN(valor) ? null : (valor * 0.9).toFixed(2);
							const valorPixFmt = valorPix ? `R$ ${valorPix.replace('.', ',')}` : 'â€”';
							
							// AÃ§Ã£o de clique na IMAGEM para abrir o modal de zoom
							const imagemHtml = p.Imagem1 
								? `<img src="${p.Imagem1}" alt="${p.Modelos}" class="card-img-top" onclick='abrirModal(${JSON.stringify(p).replace(/"/g, "&quot;")})'>`
								: `<div class="em-breve">ğŸ•’ Imagens em breve</div>`;
								
							return `
								<div class="col-6 col-md-4 col-lg-3">
									<div class="card h-100">
										${imagemHtml}
										<div class="card-body">
											<h5>${p.Modelos}</h5>
											<p><strong>Marca:</strong> ${p.Marca}</p>
											<p>${p.Tamanho ? `<strong>Tamanho:</strong> ${p.Tamanho}` : ""}</p>
											<p class="valor"><strong>${p.Venda}</strong><span>em atÃ© 3x sem juros</span></p>
											<p class="valor"><strong>${valorPixFmt}</strong><span>Ã  vista no Pix (10% OFF)</span></p>
											
											<button onclick="adicionarAoCarrinho('${p.Modelos}', '${p.Marca}', '${p.Venda}', 'TÃªnis')" 
												class="btn btn-sm btn-add-carrinho w-100">
												ğŸ›ï¸ Adicionar ao Pedido
											</button>
										</div>
									</div>
								</div>`;
						}).join("")}
					</div>
				</section>`;
		}

		function scrollToSection(id) {
			const section = document.getElementById(id);
			if (section) section.scrollIntoView({ behavior: "smooth", block: "start" });
		}

	Â  function abrirModal(produto) {
Â  Â  const modalConteudo = document.getElementById("modalConteudo");
Â  Â  const imagens = [
Â  Â  Â  produto.Imagem1, produto.Imagem2, produto.Imagem3,
Â  Â  Â  produto.Imagem4, produto.Imagem5, produto.Imagem6, produto.Imagem7
Â  Â  ].filter(img => img && img.trim() !== "");

Â  Â  if (imagens.length > 0) {
Â  Â  Â  modalConteudo.innerHTML = `
Â  Â  Â  Â  <div id="carouselImagens" class="carousel slide" data-bs-interval="false">
Â  Â  Â  Â  Â  <div class="carousel-inner">
Â  Â  Â  Â  Â  Â  ${imagens.map((img, i) => `
Â  Â  Â  Â  Â  Â  Â  <div class="carousel-item ${i === 0 ? 'active' : ''}">
Â  Â  Â  Â  Â  Â  Â  Â  <div class="zoom-area">
Â  Â  Â  Â  Â  Â  Â  Â  Â  <img src="${img}" class="zoomable d-block" alt="${produto.Modelos}">
Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  </div>`).join("")}
Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  <button class="carousel-control-prev" type="button" data-bs-target="#carouselImagens" data-bs-slide="prev">
Â  Â  Â  Â  Â  Â  <span class="carousel-control-prev-icon"></span>
Â  Â  Â  Â  Â  </button>
Â  Â  Â  Â  Â  <button class="carousel-control-next" type="button" data-bs-target="#carouselImagens" data-bs-slide="next">
Â  Â  Â  Â  Â  Â  <span class="carousel-control-next-icon"></span>
Â  Â  Â  Â  Â  </button>
Â  Â  Â  Â  </div>`;
	  // Usa um pequeno timeout para garantir que o carrossel esteja carregado antes de inicializar o zoom
Â  Â  Â  setTimeout(inicializarZoom, 300); 
Â  Â  } else {
Â  Â  Â  modalConteudo.innerHTML = `<div class="em-breve">ğŸ•’ Imagens em breve</div>`;
Â  Â  }

Â  Â  document.querySelector("#modalImagem .modal-title").innerText =
Â  Â  Â  `${produto.Marca} - ${produto.Modelos}`;
Â  Â  new bootstrap.Modal(document.getElementById("modalImagem")).show();
Â  }
	
	// FunÃ§Ã£o de inicializar o zoom (mantida)
	Â  function inicializarZoom() {
	Â  Â  document.querySelectorAll('.zoomable').forEach(img => {
	Â  Â  Â  let scale = 1, lastScale = 1;
	Â  Â  Â  let isDragging = false, startX = 0, startY = 0, originX = 0, originY = 0;
	      
	      // Reseta a escala e posiÃ§Ã£o de imagens que podem ter sido zooadas antes
	      img.style.transform = `translate(0px, 0px) scale(1)`;
	      img.classList.remove('zoomed');
	      scale = 1; originX = 0; originY = 0;
	      
	Â  Â  Â  // DÃª duplo clique para ampliar/reduzir
	Â  Â  Â  const toggleZoom = e => {
	Â  Â  Â  Â  if (scale === 1) {
	Â  Â  Â  Â  Â  scale = 2.2;
	Â  Â  Â  Â  Â  img.classList.add('zoomed');
	Â  Â  Â  Â  Â  img.style.cursor = 'grab';
	Â  Â  Â  Â  } else {
	Â  Â  Â  Â  Â  scale = 1;
	Â  Â  Â  Â  Â  originX = originY = 0;
	Â  Â  Â  Â  Â  img.classList.remove('zoomed');
	Â  Â  Â  Â  Â  img.style.cursor = 'zoom-in';
	Â  Â  Â  Â  }
	Â  Â  Â  Â  img.style.transform = `translate(${originX}px, ${originY}px) scale(${scale})`;
	Â  Â  Â  };
	
	Â  Â  Â  img.addEventListener('dblclick', toggleZoom);
	Â  Â  Â  img.addEventListener('touchend', e => {
	Â  Â  Â  Â  if (e.touches.length === 0 && e.changedTouches.length === 1) {
	Â  Â  Â  Â  Â  // toque rÃ¡pido (simulando duplo toque)
	Â  Â  Â  Â  Â  const now = new Date().getTime();
	Â  Â  Â  Â  Â  if (img.dataset.lastTouch && now - img.dataset.lastTouch < 300) {
	Â  Â  Â  Â  Â  Â  toggleZoom(e);
	Â  Â  Â  Â  Â  }
	Â  Â  Â  Â  Â  img.dataset.lastTouch = now;
	Â  Â  Â  Â  }
	Â  Â  Â  });
	
	Â  Â  Â  // Arrastar imagem quando ampliada
	Â  Â  Â  img.addEventListener('mousedown', e => {
	Â  Â  Â  Â  if (scale > 1) {
	Â  Â  Â  Â  Â  isDragging = true;
	Â  Â  Â  Â  Â  startX = e.clientX - originX;
	Â  Â  Â  Â  Â  startY = e.clientY - originY;
	Â  Â  Â  Â  Â  img.style.cursor = 'grabbing';
	Â  Â  Â  Â  Â  e.preventDefault();
	Â  Â  Â  Â  }
	Â  Â  Â  });
	
	Â  Â  Â  window.addEventListener('mouseup', () => {
	Â  Â  Â  Â  isDragging = false;
	Â  Â  Â  Â  img.style.cursor = scale > 1 ? 'grab' : 'zoom-in';
	Â  Â  Â  });
	
	Â  Â  Â  window.addEventListener('mousemove', e => {
	Â  Â  Â  Â  if (!isDragging) return;
	Â  Â  Â  Â  originX = e.clientX - startX;
	Â  Â  Â  Â  originY = e.clientY - startY;
	Â  Â  Â  Â  img.style.transform = `translate(${originX}px, ${originY}px) scale(${scale})`;
	Â  Â  Â  });
	
	Â  Â  Â  // Toque e arraste (mobile)
	Â  Â  Â  let lastTouch = null;
	Â  Â  Â  img.addEventListener('touchmove', e => {
	Â  Â  Â  Â  if (scale > 1 && e.touches.length === 1) {
	Â  Â  Â  Â  Â  if (!lastTouch) {
	Â  Â  Â  Â  Â  Â  lastTouch = e.touches[0];
	Â  Â  Â  Â  Â  Â  return;
	Â  Â  Â  Â  Â  }
	Â  Â  Â  Â  Â  const dx = e.touches[0].pageX - lastTouch.pageX;
	Â  Â  Â  Â  Â  const dy = e.touches[0].pageY - lastTouch.pageY;
	Â  Â  Â  Â  Â  originX += dx;
	Â  Â  Â  Â  Â  originY += dy;
	Â  Â  Â  Â  Â  img.style.transform = `translate(${originX}px, ${originY}px) scale(${scale})`;
	Â  Â  Â  Â  Â  lastTouch = e.touches[0];
	Â  Â  Â  Â  Â  e.preventDefault();
	Â  Â  Â  Â  }
	Â  Â  Â  });
	
	Â  Â  Â  img.addEventListener('touchend', () => (lastTouch = null));
	Â  Â  });
	Â  }
	  
		async function carregarDados() {
			carregarCarrinho();
		Â  try {
		Â  Â  const response = await fetch("catalogo/tenis.json");
		Â  Â  if (!response.ok) throw new Error("Falha no fetch do JSON");
		Â  Â  tenis = await response.json();
		Â  Â  renderizarMarcas(tenis);
		
		Â  Â  // Se a URL tiver um hash (#nike, #adidas, etc), rola apÃ³s o render
		Â  Â  setTimeout(() => {
		Â  Â  Â  const hash = window.location.hash.replace("#", "");
		Â  Â  Â  if (hash) {
		Â  Â  Â  Â  const target = document.getElementById(hash);
		Â  Â  Â  Â  if (target) {
		Â  Â  Â  Â  Â  target.scrollIntoView({ behavior: "smooth", block: "start" });
		Â  Â  Â  Â  }
		Â  Â  Â  }
		Â  Â  }, 400); 
		Â  } catch (error) {
		Â  Â  console.warn("Erro ao carregar JSON, usando fallback JS:", error);
		Â  Â  const script = document.createElement("script");
		Â  Â  script.src = "catalogo/tenis.js";
		Â  Â  script.onload = () => {
		Â  Â  Â  if (typeof tenisBackup !== "undefined") {
		Â  Â  Â  Â  tenis = tenisBackup;
		Â  Â  Â  Â  renderizarMarcas(tenis);
		
		Â  Â  Â  Â  setTimeout(() => {
		Â  Â  Â  Â  Â  const hash = window.location.hash.replace("#", "");
		Â  Â  Â  Â  Â  if (hash) {
		Â  Â  Â  Â  Â  Â  const target = document.getElementById(hash);
		Â  Â  Â  Â  Â  Â  if (target) {
		Â  Â  Â  Â  Â  Â  Â  target.scrollIntoView({ behavior: "smooth", block: "start" });
		Â  Â  Â  Â  Â  Â  }
		Â  Â  Â  Â  Â  }
		Â  Â  Â  Â  }, 400);
		Â  Â  Â  }
		Â  Â  };
		Â  Â  document.body.appendChild(script);
		Â  }
		}

		document.getElementById("search").addEventListener("input", e => {
			const termo = e.target.value.toLowerCase();
			const filtrados = tenis.filter(p =>
				p.Modelos.toLowerCase().includes(termo) ||
				p.Marca.toLowerCase().includes(termo)
			);
			renderizarMarcas(filtrados);
		});

		carregarDados();
	</script>

	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>

	<footer>
		Â© 2025 Nektar. Todos os direitos reservados.<br>
		<small>Feito com ğŸ’™ e estilo.</small>
	</footer>
</body>

</html>
